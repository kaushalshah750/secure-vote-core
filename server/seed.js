const mongoose = require('mongoose');
const { Voter, Candidate, Config } = require('./models/schemas');

// MongoDB Connection
mongoose.connect('mongodb://localhost:27017/secure_vote_db')
    .then(() => console.log('‚úÖ Connected to MongoDB'))
    .catch(err => console.error(err));

// --- 1. CONFIGURATION ---
const candidates = [
    { name: 'Rahul Sharma', party: 'Independent', photoUrl: 'assets/c1.png' },
    { name: 'Priya Singh', party: 'Independent', photoUrl: 'assets/c2.png' },
    { name: 'Amit Patel', party: 'Independent', photoUrl: 'assets/c3.png' }
];

// --- 2. RAW DATA (Exact Copy-Paste from your message) ---
const rawExcelData = `1	E-501	ORDINARY	ASAWA ASHOK KUMAR SHREENIVAS	919374504934	917878174908	
2	E-502	ORDINARY	ASAWA GHANSHYAM DAS MADAN LAL	919374711738	919825471718	
3	E-503	ORDINARY	ASAWA PRAHLAD RAI G	919377793770	9825681099	
4	E-504	ORDINARY	BAGRI RAJKUMAR GANESHMALJI	919825471515	+91-	
5	E-505	ORDINARY	BAHETI KANTILAL INDORCAHND	919879338841	+91-	
6	E-506	ORDINARY	BAHETY PRABHUDAYAL RAMAKISHANJI	9374666121	+91-	
7	E-507	ORDINARY	BAHETY RAVI RAMESH CHANDRA	9426115161		
8	E-508	ORDINARY	BAJAJ DHANRAJ GORDHEN	919898015030		
9	E-509	ORDINARY	BAJAJ KAMALKISHOR BHIVRAJJI	919825141965	918238220619	
10	E-510	ORDINARY	BAJAJ HEAMANT VASUDEV	919723693911	919898637828	
11	E-511	ORDINARY	BAJAJ PUNIT NARAYANLAL	8160997653		
12	E-512	ORDINARY	BAJAJ RADHESHYAM JI GORDHAN DAS	919898025513	+91-	
13	E-513	ORDINARY	BHALA NANDKISHOR M	919879338842	+91-	
14	E-514	ORDINARY	BHANDARI KAMALKISHOR RAMPAL	919371111777	+91-	
15	E-515	ORDINARY	BHANDARI SANJAY S	9374861844	+91-	
16	E-516	ORDINARY	BHANDARI VIJAY KUMAR KAMAL KISHOR	919845145999	+91-	
17	E-517	ORDINARY	BHATTAR MADHUSUDAN PARASRAM	919824106113	+91-	
18	E-518	ORDINARY	BHATTAR RAMANUJ P	919824199481	919824449999	
19	E-519	ORDINARY	BHUTRA BHAGIRATH SHIVNARAYAN	919374717291	+91-	
20	E-520	ORDINARY	BHUTRA RAMESHKUMAR GOPI KISHAN	9824151939	+91-	
21	E-521	ORDINARY	BHUTRA ALOK RAMNIWAS 	+91-	+91-	
22	E-522	ORDINARY	BISANI SHYAM LAXMINARAYAN	919374708605	+91-	
23	E-523	ORDINARY	BISANI NAVNEET MADEANLAL	919825147695	+91-	
24	E-524	ORDINARY	BISANI SRI KISHAN JIGAR	919374712954	+91-	
25	E-525	ORDINARY	BIYANI MAHESH DWARKA PRASAD	919824145679	919376857000	
26	E-526	ORDINARY	BIYANI JYOTI VINAY	919898211255	+91-	
27	E-527	ORDINARY	BIHANI SUSHIL KUMAR HULAS CHAND	919727023724	+91-	
28	E-528	ORDINARY	BIYANI VINAY SHYAMSUNDAR	919825138771	+91-	
29	E-529	ORDINARY	BIYANI VINOD SHYAM SUNDER	919426114700	+91-	
30	E-530	ORDINARY	BIYANI VIPIN SHYAM SUNDERJI	919825877000	+91-	
31	E-531	ORDINARY	BANG SOHAN HARI RAM	919392481581	919374596600	
32	E-532	ORDINARY	BANG VIJAY KUMAR SHRI BANSHILAL JI	+91-	919825944285	
33	E-533	ORDINARY	CHANDAK JAI NARAYAN CHOTILAL	919350406170	+91-	
34	E-534	ORDINARY	CHANDAK NANDKISHORE MEGHRAJ	919374513573	918200220522	
35	E-535	ORDINARY	CHANDAK NARAYANDAS GOVIND RAM	919374721434	917990274592	
36	E-536	ORDINARY	CHANDAK RADHE SHYAM MEGHRAJ	919825282420	+91-	
37	E-537	ORDINARY	CHANDAK RAMVALLABH SATYANARAYAN	919825134569	+91-	
38	E-538	ORDINARY	CHANDAK SANDEEP UMASHANKAR	9825109077	+91-	
39	E-539	ORDINARY	CHHAPARWAL NATWARGOAPL BRIJMOHANJI	919824102371	+91-	
40	E-540	ORDINARY	CHHAPARWAL SHYAM SUNDER RAM MARYAN	919825280161	+91-	
41	E-541	ORDINARY	DARAK NANDKISHORE GANSHYAM DAS	919825097282	+91-	
42	E-542	ORDINARY	DARAK HARSH MADHUSUDAN	919724724429	919328453217	
43	E-543	ORDINARY	DHIRAN OMPRAKASH JI GANSHYAMDAS	919825121192	919574126000	
44	E-544	ORDINARY	DHOOT ANKESH KAILASH	9327661676	+91-	
45	E-545	ORDINARY	DHOOT NARAYANDAS RATANLAL	919327335181	+91-	
46	E-546	ORDINARY	DIGGA NAARYAN DAS CHAGANLAL	919825124128	919825132228	
47	E-547	ORDINARY	DUDHANI MANISH KUMAR BRIJLAL	919825115881	+91-	
48	E-548	ORDINARY	DUDHANI TRIVENI DEVI BRJLAL	9426187810	+91-	
49	E-549	ORDINARY	GANDHI BALURAM SEVARAM	919727475364	+91-	
50	E-550	ORDINARY	GADHI DWARKAPRASAD B.	91 9825508342		
51	E-551	ORDINARY	GANDHI OMPRAKASH JAYNARAYAN	919825139921	+91-	
52	E-552	ORDINARY	GANDHI RAMESHWAR JAYNARAYAN	9825593351	+91-	
53	E-553	ORDINARY	GANDHI RAMGOPAL RAMCHANDRA	919428628737	919327606474	
54	E-554	ORDINARY	GATTANI NAND KISHORE BHATMAL	919376917745	+91-	
55	E-555	ORDINARY	GIRLA GIRIRAJ SATYANARAYAN JI	919374864252	+91-	
56	E-556	ORDINARY	HARKUT MANOJ RAMGOPAL 	-9825033174	+91-	
57	E-557	ORDINARY	HEDA NANDKISHOR RAMNIVASH JI	+91-	919377668671	
58	E-558	ORDINARY	INANI ANIL KUMAR HIRALAL	9426104361	+91-	
59	E-559	ORDINARY	JAITHALIA BHAGWATI PRASAD PANNA LAL	919925161039	919898579647	
60	E-560	ORDINARY	JAITHALIA MADAN MOHAN HIRALAL	9328823777	+91-	
61	E-561	ORDINARY	JAITHALIA PARMESHWAR PANNALAL	9328052490	+91-	
62	E-562	ORDINARY	JAJOO PIYUSH GOBIND PRASAD	919374727200		
63	E-563	ORDINARY	JAJOO MANISH GANSHYAM	9898591581	+91-	
64	E-564	ORDINARY	JAJOO NIRANJAN KUMAR BHAGWAN	919828080331	919824142822	
65	E-565	ORDINARY	JAJOO PRATIK RAJESH	919998023402	+91-	
66	E-566	ORDINARY	JAJOO SUNIL KUMAR LAXMINARAYAN	919825118623	+91-	
67	E-567	ORDINARY	JAKHOTIA KAMALKISHORE R	+91-	+91-	
68	E-568	ORDINARY	JAKHOTIA PURSHOTTAM MAYARAMJI	919422413909	+91-	
69	E-569	ORDINARY	JHAWAR ASHOK KUMAR BHERU LAL	919377749321	+91-	
70	E-570	ORDINARY	JHANWAR ANKIT BHERULAL	9374625350	+91-	
71	E-571	ORDINARY	JHAWAR CHAMAPALAL DULICHAND	919377712140	+91-	
72	E-572	ORDINARY	JHAWAR DEEPCHAND KESHRICHAND	919377151091	919925938666	
73	E-573	ORDINARY	JHANWAR PAWANKUMAR BHERULAL	919377700777	+91-	
74	E-574	ORDINARY	PORWAL REKHA SANJAY	-982555201	+91-	
75	E-575	ORDINARY	JHAWAR SATYANARAYAN JAGANNATHJI	919824154704	919327387303	
76	E-576	ORDINARY	JHAWAR SHOBHA RATANLAL	9227651000	+91-	
77	E-577	ORDINARY	JHAWAR SURENDRA KUMAR NARAYAN PRASAD	9374711212	+91-	
78	E-578	ORDINARY	KABRA ACHIN RAJENDRA JI	919377155666	919712039915	
79	E-579	ORDINARY	KABRA ANOOP KUMAR SHIV CHAND	919375014255	+91-	
80	E-580	ORDINARY	KABRA ARUN GANPATRAI	919824125420	+91-	
81	E-581	ORDINARY	KABRA BAJRANG LAL MURLIDHAR	9824386950	+91-	
82	E-582	ORDINARY	KABRA GAURAV BHAWANI SHANKAR	9016377474	+91-	
83	E-583	ORDINARY	KABRA LATA DEVI SHYAM SUNDER	+91-9328184205	+91-	
84	E-584	ORDINARY	KABRA ANISH PAWAN KUMAR	9033607548	+91-	
85	E-585	ORDINARY	KABRA PAWAN KUMAR DURGADUTT	919974711220	+91-	
86	E-586	ORDINARY	KABRA PANKAJ PRADIP	918278394507	919374713114	
87	E-587	ORDINARY	KABRA PRAVEEN CHANDRA	+91-	919376824376	
88	E-588	ORDINARY	KABRA ANUJ RAJENDRA	919837571680	+91-	
89	E-589	ORDINARY	KABRA SARITA PAWAN KUMAR	919374711220		
90	E-590	ORDINARY	KABRA SHYAM SUNDAR DURGA DUTT	919328184205	+91-	
91	E-591	ORDINARY	KALYANI KAILASH BHAGWAN	919227900118	+91-	
92	E-592	ORDINARY	KALYANI KOMAL KAILASH	9426122632	+91-	
93	E-593	ORDINARY	KAPURIA KAMALKISHRE SANWANTMAL	9898019814	+91-	
94	E-594	ORDINARY	KARWA SURESH CHANDRA CHANDANMAL	919328287101	+91-	
95	E-595	ORDINARY	KASAT CHANDRAKANT RAMNIVASH	9825125982	+91-	
96	E-596	ORDINARY	KASAT HARSHAD KUNJBIHARI 	9662046969	+91-	
97	E-597	ORDINARY	PRASAD RAMAKANT RAMNIVASH	919374020007	+91-	
98	E-598	ORDINARY	KELA CHNDRAKANT HATHIRAMJI	9925140005	+91-	
99	E-599	ORDINARY	KOTHARI ARVIND S	+91-	+91-	
100	E-600	ORDINARY	KOTHARI ASHOK KUMAR LAXMINARAYAN	9374201664	+91-	
101	E-601	ORDINARY	KOTHARI BALKISHAN MADANLAL	919327385000	+91-	
102	E-602	ORDINARY	KOTHARI HARISH GOPI KISHAN JI	919727289239	919724505633	
103	E-603	ORDINARY	KOTHARI RAMDAYAL SHIVNARAYAN	9825650913	+91-	
104	E-604	ORDINARY	LADDHA ANIL RIDHIKARAN	919376920001	+91-	
105	E-605	ORDINARY	LADDHA GOVIND BHERULAL	919825142720	+91-	
106	E-606	ORDINARY	LARA HARI PRASAD SATYANARAYAN	9374717152	+91-	
107	E-607	ORDINARY	LADDHA MAHESH KUMAR NANDLAL	919825148288	+91-	
108	E-608	ORDINARY	LADDHA KISHAN KUMAR SURENDRA	919712555739	919374512560	
109	E-609	ORDINARY	LAHOTI JAGDISH CHANDRA SREE RAMJI	919374707118	+91-	
110	E-610	ORDINARY	LAHOTI KARNIDAN GANGA BHISAN	9327323930	+91-	
111	E-611	ORDINARY	LAHOTI LAL CHAND MOHANLAL	919328273440	919825138940	
112	E-612	ORDINARY	LAHOTI RAMESHWARLAL AGYAARM	9375551500	+91-	
113	E-613	ORDINARY	LAHOTI RAMNIWAS SAMPAT	919327454089	+91-	
114	E-614	ORDINARY	LAHOTI SHIV RATAN SHREE RAM	919377340262		
115	E-615	ORDINARY	LOYA RAMDEV JETHMAL	919825407695	91	
116	E-616	ORDINARY	MAHESHWARI BHARAT KUMAR C	9825119991	+91-	
117	E-617	ORDINARY	MAHESHWARI CHARAT RAM MADANLAL	919825115364	+91-	
118	E-618	ORDINARY	MAHESHWARI MADAN LAL GAUTAM DAS	919328058127	+91-	
119	E-619	ORDINARY	MAHESHWARI SHIV RATAN JAGAN NATHJI	919825125172	+91-	
120	E-620	ORDINARY	MALANI SUSHIL KUMAR RAMNIVASH	+91-	919825140442	
121	E-621	ORDINARY	MALL BRIJMOHAN SATYANARAYAN	919376933322	919662790751	
122	E-622	ORDINARY	MALPANI DINESH KUNMAR BADRI PRASD JI	919426812615	+91-	
123	E-623	ORDINARY	MALPANI KAMAL KISHORE JI GANESHRAM	9374722678	+91-	
124	E-624	ORDINARY	MALPANI PREM RATAN RAM KISHAN	919428869850	+91-	
125	E-625	ORDINARY	MALPANI RAMESH KUMAR BADRI PRASAD	919825321626	+91-	
126	E-626	ORDINARY	MANTRI SURAJMAL CHANDANMAL	9374550069	+91-	
127	E-627	ORDINARY	MARU SHREYANS DWARKA DAS 	9909601965		
128	E-628	ORDINARY	MARU GOVIND DAS NARAYAN DAS	919327320141	+91-	
129	E-629	ORDINARY	MARU KAUSAL DAS NARAIN DAS	917567880000	+91-	
130	E-630	ORDINARY	MARU NARSHING DAS RADHAMOHAN	919374713240	+91-	
131	E-631	ORDINARY	MEHTA DEEN DAYAL HARIVALLABH	919374721971	+91-	
132	E-632	ORDINARY	MIMANI SATYANARAYAN N	9374721971	+91-	
133	E-633	ORDINARY	MODANI KAILASH NARAYAN N	919374557100	91+737077258	
134	E-634	ORDINARY	MODANI MURLI MANOHAR NORATMAL	919825127106	+91-	
135	E-635	ORDINARY	MOHTA ASHOK KUMAR M	919824120055	+91-	
136	E-636	ORDINARY	MOHTA RAMRATAN RAMANLAL	919825118076	919574176000	
137	E-637	ORDINARY	MUNDHRA ANIL KUAMR RAMKISHAN	919377677779	+91-	
138	E-638	ORDINARY	MUNDHRA AMIT KUMAR BALMUKUND	8000866622	+91-	
139	E-639	ORDINARY	MUNDHRA BRIJMOHAN GUKULCHAND	919827481007	+91-	
140	E-640	ORDINARY	MUNDHRA GANGAVISHAL SRI MOHANLAL	919825281204	919879240320	
141	E-641	ORDINARY	MUNDHRA GANSHYAM DAS SHYAM SUNDER	919825174517	919327481004	
142	E-642	ORDINARY	MUNDHRA GHISULAL R	919375022671	+91-	
143	E-643	ORDINARY	MUNDHRA GOPIKISHAN BHANWARLAL	+91-	919825182515	
144	E-644	ORDINARY	MUNDHRA GOVINDRAM MOOLCHAND	918209453882	+91-	
145	E-645	ORDINARY	MUNDHARA KAILASH CHAND GOKULCHAND	919327481001	+91-	
146	E-646	ORDINARY	MUNDHRA KISHANGOPAL RAMKISHAN	919825147557	919375280708	
147	E-647	ORDINARY	MUNDHRA KUNDALMAL MOHANLAL	9426189210	+91-	
148	E-648	ORDINARY	MUNDHRA MAAHVIRPRASAD GOKULCHNAD JI	919327481000	+91-	
149	E-649	ORDINARY	MUNDHRA MURLI MANOHAR ROHIT KUMAR	9377755556	+91-	
150	E-650	ORDINARY	MUNDHRA OMPRAKSH RAMPRASAD JI	919374726521	919374930238	
151	E-651	ORDINARY	MUNDHRA RADHESHYAM JI JIYALAL	919327331804	919426211804	
152	E-652	ORDINARY	SABOO GIRDHARLAL GANPATLAL	919374558322	+91-	
153	E-653	ORDINARY	MUNDHRA RAMKISHAN BHERUDAN	9375163999	+91-	
154	E-654	ORDINARY	MUNDHRA RAM KISHAN MOOL CHAND	9374545600	+91-	
155	E-655	ORDINARY	MUNDHRA RAM SWAROOP MADAN LAL	9825108698	+91-	
156	E-656	ORDINARY	MUNDHRA SHIV¬† SHANKAR RAMKISHAN	919377715557	+91-	
157	E-657	ORDINARY	MUNDHRA SANJAY KUMAR SITARAM	9825112773	+91-	
158	E-658	ORDINARY	MUNDHRA SHREE KISHAN TAKHAT	919374705236	+91-	
159	E-659	ORDINARY	PANPALIYA AMRIT LAL PEERDAN	919898378507	+91-	
160	E-660	ORDINARY	PANPALIYA RATANLAL PIRDAN	917567856697	+91-	
161	E-661	ORDINARY	PERIWAL BALMUKUND SUGANCHAND	919780990370	919374555403	
162	E-662	ORDINARY	PERIWAL DAMODARPRASD SAGARCHAND	9374738665	+91-	
163	E-663	ORDINARY	PERIWAL GURU PRASD RAMKUMAR	919374706354	919409106354	
164	E-664	ORDINARY	PERIWAL KAILASH CHANDRA SUKHDEV	919374562600	+91-	
165	E-665	ORDINARY	PERIWAL KISHAN KUMAR TOLA RAM	9427138819	+91-	
166	E-666	ORDINARY	PERIWAL SWAMI PRASD RAMKUMAR	919377606354	918668760571	
167	E-667	ORDINARY	PHOPHALIA NANDKISHORE MADANLAL	919824128410	919978805490	
168	E-668	ORDINARY	PHOPHALIA RAJENDRA DAUKAL	919374719024	+91-	
169	E-669	ORDINARY	PHOPHALIA REKHA NANDKISHORE	919824128410	919978805490	
170	E-670	ORDINARY	RATHI BALKISHAN BHANWARLAL	919825361180	+91-	
171	E-671	ORDINARY	RATHI RASHMI BHAGAWANDAS	9978835834	+91-	
172	E-672	ORDINARY	RATHI JUGAL KISHORE	917878333000	918905555000	
173	E-673	ORDINARY	RATHI NARMADA PRASAD HIRA CHAND	919824051903	+91-	
174	E-674	ORDINARY	RATHI PANKAJ KUMAR BHAGWANDAS	919824134389	+91-	
175	E-675	ORDINARY	RATHI PRIYAG CHAND BHAGYESH	7990308005	+91-	
176	E-676	ORDINARY	RATHI SATYANARAYAN JI UNKARCHAND	919825149076	+91-	
177	E-677	ORDINARY	RATHI SHRIKISHAN JI BHANWERLAL JI	919825454511	919726347743	
178	E-678	ORDINARY	RATHI SHRINIWAS H	9824198511	+91-	
179	E-679	ORDINARY	SABOO ARVIND RAMAVTAR	919426108133	+91-	
180	E-680	ORDINARY	SABOO MURARILAL GANPATLAL	919374539270	919375118163	
181	E-681	ORDINARY	SABOO SANTOSH KUMAR MADANLAL	919898156577	+91-	
182	E-682	ORDINARY	SARDA DAUDAYAL MVLATANCHAND	919376245717	+91-	
183	E-683	ORDINARY	SARDA GOPAL DAS GANSHYAM DAS	919825155689	+91-	
184	E-684	ORDINARY	SARDA MOHIT INDER KUMAR	919662238905	+91-	
185	E-685	ORDINARY	SARDA KAMLESH BAJRANGLAL	919824198511	+91-	
186	E-686	ORDINARY	SARDA LILADHAR MOHAN LAL	919825121180	+91-	
187	E-687	ORDINARY	SARAD YOGESH RAJENDRA	740550176	+91-	
188	E-688	ORDINARY	SARDA SHRILAL RAMESHWAR DAS	919327549449	+91-	
189	E-689	ORDINARY	SINGHI ANIL KUMAR SHAUKALLAL	9824114621	+91-	
190	E-690	ORDINARY	SODHANI DINESH KUMAR BALLABHDAS	9375957582	+91-	
191	E-691	ORDINARY	SOMANI JAGDISH CHANDRA J	+91-9375555578	+91-9375555578	
192	E-692	ORDINARY	SOMANI KAMAL MOHANLAL	9377066023	+91-	
193	E-693	ORDINARY	SOMANI MAHESH KUMAR DAMODAR	919825504995	+91-	
194	E-694	ORDINARY	SOMANI MURLI MANOHAR DAMODAR	919879564442	+91-	
195	E-695	ORDINARY	SOMANI SHARAD J	+91-	+91-	
196	E-696	ORDINARY	SOMANI SHASHI RANAJAN HARNARAYAN	919374716202	+91-	
197	E-697	ORDINARY	SONI KRISHAN GOPAL	919374729083	918200571276	
198	E-698	ORDINARY	SONI NARAYAN DAS KISHAN	919825120580	919328320580	
199	E-699	ORDINARY	TAPARIA VEKATESH MAHAVIR PRASAD	9428472922	+91-	
200	E-700	ORDINARY	TAPARIA RADHA BALLABH MADAN LAL	919375935885	917016841860	
201	E-701	ORDINARY	TAWARI MADANLAL KHIVRAJ	919824051907	919375040400	
202	E-702	ORDINARY	TOSHNIWAL BADRINARAYAN H	9377713340	+91-	
203	E-703	ORDINARY	TOSHNIWAL SURENDRA KUMAR RATANLAL	7359998355	+91-	
204	E-704	ORDINARY	TOSHNIWAL SHREE KUMAR P	919831154089	+91-	
205	E-705	ORDINARY	TOSHNIWAL SURESH 	919374751665	+91-	
206	E-706	ORDINARY	TOTLA MAN MOHAN BALKISHAN	919825141457	+91-	
207	E-707	ORDINARY	TOTLA PRADEEP KUMAR GOVIND NARAYAN	+91-9825117733	+91-	
`;

// --- HELPER: CLEAN NUMBER (STRICT 10 DIGIT) ---
function cleanPhoneNumber(raw) {
    if (!raw) return null;
    
    // 1. Remove all non-digits (spaces, -, +)
    let p = raw.toString().replace(/\D/g, '');

    // 2. Handle prefixes (91 or 0)
    // If length is 12 and starts with 91 -> Remove 91
    if (p.length === 12 && p.startsWith('91')) {
        p = p.substring(2);
    }
    // If length is 11 and starts with 0 -> Remove 0
    else if (p.length === 11 && p.startsWith('0')) {
        p = p.substring(1);
    }

    // 3. Strict Check: Must be exactly 10 digits now
    if (p.length !== 10) return null;

    return p;
}

// --- MAIN LOGIC ---
const seedDB = async () => {
    try {
        console.log('üßπ Clearing old data...');
        await Voter.deleteMany({});
        await Candidate.deleteMany({});
        await Config.deleteMany({});

        // Add Candidates
        await Candidate.insertMany(candidates);
        console.log('‚úÖ Candidates Added');

        // Process Excel Data
        const lines = rawExcelData.trim().split('\n');
        const voters = [];
        const skipped = [];

        console.log(`Processing ${lines.length} rows...`);

        lines.forEach((line, index) => {
            // Split by Tab
            const parts = line.split('\t');
            
            // Expected Format based on your data:
            // 0: SNo, 1: MemNo, 2: Group, 3: Name, 4: Mobile1, 5: Mobile2
            
            if (parts.length >= 5) {
                const name = parts[3].trim();
                const rawMob1 = parts[4] ? parts[4].trim() : '';
                const rawMob2 = parts[5] ? parts[5].trim() : '';

                let finalPhone = cleanPhoneNumber(rawMob1);

                // If Mobile 1 is bad, try Mobile 2
                if (!finalPhone) {
                    finalPhone = cleanPhoneNumber(rawMob2);
                }

                // If we found a valid 10 digit number
                if (finalPhone) {
                    voters.push({
                        phone: finalPhone,
                        name: name,
                        hasVoted: false
                    });
                } else {
                    skipped.push(`${name} (No Valid Mobile)`);
                }
            }
        });

        // Insert to DB
        if (voters.length > 0) {
            await Voter.insertMany(voters);
            console.log(`‚úÖ ${voters.length} Valid Voters Added!`);
            
            console.log('\n--- üìã CLIENT DATA (Copy This) ---');
            voters.forEach(v => console.log(`${v.phone}, ${v.pin}`));
            console.log('----------------------------------');
        }

        if (skipped.length > 0) {
            console.log(`\n‚ö†Ô∏è Skipped ${skipped.length} members (No valid 10-digit number):`);
            // console.log(skipped.join('\n')); // Uncomment to see names
        }

        // Set Timer (Ends Tomorrow 6 PM)
        const endTime = new Date();
        endTime.setDate(endTime.getDate() + 1);
        endTime.setHours(18, 0, 0, 0);
        await Config.create({ key: 'ELECTION_CONFIG', endTime: endTime, isActive: true });

    } catch (err) {
        console.error('‚ùå Error:', err);
    } finally {
        mongoose.connection.close();
    }
};

seedDB();